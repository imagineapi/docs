import { Callout, Tab, Tabs, Steps } from 'nextra/components'

# 使用我们的 Midjourney API 快速入门

## 概述

这篇指南假设您正在使用一个[演示账户](https://www.imagineapi.dev/pricing)。我们将通过生成一张图片并查看结果来快速开始。您也可以选择您使用的语言。

最好的部分是，您可以立即复制并使用这段代码！

<Callout type="info" emoji="🚀">
**通过获取一个 [演示账户](https://www.imagineapi.dev/pricing)，生成 Midjourney 图片的最简单方式。**
</Callout>

<Steps>

### 获取身份验证令牌

![生成身份验证令牌的步骤动画](/authentication.gif)

 1. 一旦您购买了一个[演示账户](https://www.imagineapi.dev/pricing)，您将收到一封包含用户名和密码的电子邮件。使用这些信息登录到我们的演示服务器：[https://demo.imagineapi.dev](https://demo.imagineapi.dev)。
 1. 登录后，点击左下角的 `用户图标`：![](/authentication-token.png)
 1. 这些是您的用户设置。滚动到底部，找到 `令牌` 字段并 `点击圆形箭头按钮` 以重新生成令牌：![](/authentication-click-regenerate.png)
 1. 这将创建一个新的令牌，您可以用它来授权您的 API 调用，因此 `复制该令牌`。请将其保存在某个文件中，因为您很快就会用到它：![](/authentication-copy-token.png)
 1. 然后在右上角 `点击复选框按钮` 以保存您的账户更改：![](/authentication-save-account-changes.png)

这样就可以了。现在我们将使用该令牌来验证我们的 API 调用。

### 生成一张图片

现在您有了您的[身份验证令牌](#获取身份验证令牌)，您可以生成您的第一张图片。

选择您最喜欢的语言，看看如何操作：


```js filename="midjourney-api.js" copy
// 使用 fetch — 需要 Node.js 18 或更高版本

const data = {
    prompt: "hello world --ar 21:9 --style raw"
};

fetch('https://demo.imagineapi.dev/items/images/', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer u667iLDO2Xfu0-qpv_nu82EeeDtYGlsf', // <<<< TODO: 记得更改这个
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('错误:', error));
```

我们运行它（需要 Node.js 18 或更高版本）：

```shell
❯ node --version
v18.14.0

❯ node midjourney-api.js
```

输出将如下所示：

```js
{
  data: {
    id: "cbf8b8b3-1d35-4a22-9fa4-5c5c5c5682c9",
    prompt: "hello world --ar 21:9 --style raw",
    results: null,
    user_created: "4df804f1-e32e-4e1c-be58-6acbe48cce98",
    date_created: "2023-08-29T22:50:24.993Z",
    status: "pending",
    progress: null,
    url: null,
    error: null,
    upscaled_urls: null,
    upscaled: []
  }
}
```

现在，您的提示将被发送到 Midjourney。

需要注意的几个重要细节：

- 图像 `id` 将保持不变，我们可以用它来获取图像的数据和状态
- `状态` 默认为 `pending`，这是首次创建图像生成时的默认状态
- 当生成完成时（`status` 将变为 `completed`），`upscaled_urls` 将包含 4 个单独的图像 URL，而 `url` 将有一个包含所有四个图像的网格图像

继续往下看，了解如何[获取生成的图像](#获取生成的图像)。

### 获取生成的图像

在演示服务器中生成图像最多需要 30 秒。我们使用了启用了 **turbo 模式** 的 Midjourney 账户，所以通常非常快。

让我们创建一个新文件，以获取我们在[上一步](#生成一张图片)中创建的图像。

```js filename="get-image.js" copy

const imageId = 'cbf8b8b3-1d35-4a22-9fa4-5c5c5c5682c9'; // <<< TODO: 记得更改这个

fetch(`https://demo.imagineapi.dev/items/images/${imageId}`, {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer u667iLDO2Xfu0-qpv_nu82EeeDtYGlsf', // <<<< TODO: 记得更改这个
        'Content-Type': 'application/json'
    }
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error('错误:', error));
```

然后我们运行它（需要 Node.js 18 或更高版本）：

```sh
❯ node --version
v18.14.0

❯ node get-image.js
```

如果图像完成生成，这是我们得到的结果：

```js
{
  data: {
    id: 'cbf8b8b3-1d35-4a22-9fa4-5c5c5c5682c9',
    prompt: 'hello world --ar 21:9 --style raw',
    results: '88071412-a748-4a2a-81c2-e91106082599',
    user_created: '4df804f1-e32e-4e1c-be58-6acbe48cce98',
    date_created: '2023-08-29T22:50:24.993Z',
    status: 'completed',
    progress: null,
    url: 'https://demo.imagineapi.dev/assets/88071412-a748-4a2a-81c2-e91106082599/88071412-a748-4a2a-81c2-e91106082599.png',
    error: null,
    upscaled_urls: [
      'https://demo.imagineapi.dev/assets/33c64de8-de37-463d-af53-f3aaea16588f/33c64de8-de37-463d-af53-f3aaea16588f.png',
      'https://demo.imagineapi.dev/assets/c0f78281-2f78-4c67-8516-5895ce330085/c0f78281-2f78-4c67-8516-5895ce330085.png',
      'https://demo.imagineapi.dev/assets/d9193d04-8e4d-4049-a2fd-fb9594b7fe8b/d9193d04-8e4d-4049-a2fd-fb9594b7fe8b.png',
      'https://demo.imagineapi.dev/assets/88db33d1-9ca4-44dd-ba89-b4cf3c1e95be/88db33d1-9ca4-44dd-ba89-b4cf3c1e95be.png'
    ],
    upscaled: [
      '33c64de8-de37-463d-af53-f3aaea16588f',
      '88db33d1-9ca4-44dd-ba89-b4cf3c1e95be',
      'c0f78281-2f78-4c67-8516-5895ce330085',
      'd9193d04-8e4d-4049-a2fd-fb9594b7fe8b'
    ]
  }
}
```

这样就完成了！您现在可以使用图像 ID 访问您的图片。

</Steps>